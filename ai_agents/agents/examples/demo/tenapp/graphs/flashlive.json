{
  "name": "flashlive",
  "auto_start": false,
  "graph": {
    "nodes": [
      {
        "type": "extension",
        "name": "agora_rtc",
        "addon": "agora_rtc",
        "extension_group": "default",
        "property": {
          "app_id": "${env:AGORA_APP_ID}",
          "app_certificate": "${env:AGORA_APP_CERTIFICATE|}",
          "channel": "ten_agent_test",
          "stream_id": 1234,
          "remote_stream_id": 123,
          "subscribe_audio": true,
          "publish_audio": true,
          "publish_data": true,
          "enable_agora_asr": false,
          "audio_frame_send_delay_ms": 0,
          "subscribe_audio_samples_per_frame": 160
        }
      },
      {
        "type": "extension",
        "name": "stt",
        "addon": "deepgram_ws_asr_python",
        "extension_group": "stt",
        "property": {
          "params": {
            "api_key": "${env:DEEPGRAM_API_KEY}",
            "url": "wss://api.deepgram.com/v2/listen",
            "model": "flux-general-en",
            "language": "en-US",
            "eot_threshold": 0.65,
            "eot_timeout_ms": 1000,
            "eager_eot_threshold": 0.35
          },
          "sample_rate": 16000,
          "encoding": "linear16",
          "interim_results": true,
          "punctuate": true,
          "interrupt_on_speech": true
        }
      },
      {
        "type": "extension",
        "name": "llm",
        "addon": "gemini_llm2_python",
        "extension_group": "chatgpt",
        "property": {
          "api_key": "${env:GEMINI_API_KEY}",
          "model": "gemini-2.0-flash-exp",
          "max_tokens": 1024,
          "temperature": 0.7,
          "prompt": "You are FlashLive, a helpful and friendly AI voice assistant. Keep your responses concise and conversational since this is a voice chat. Be natural, engaging, and helpful. Respond in 1-3 sentences unless the user asks for more detail.",
          "greeting": "Hey there! I'm FlashLive, your AI assistant. What can I help you with today?",
          "max_memory_length": 10
        }
      },
      {
        "type": "extension",
        "name": "tts",
        "addon": "inworld_tts_python",
        "extension_group": "tts",
        "property": {
          "params": {
            "api_key": "${env:INWORLD_API_KEY}",
            "voice_id": "Ashley",
            "model_id": "inworld-tts-1",
            "sample_rate": 16000
          }
        }
      },
      {
        "type": "extension",
        "name": "main_control",
        "addon": "main_cascade_python",
        "extension_group": "control",
        "property": {
          "greeting": "Hey there! I'm FlashLive, your AI assistant. What can I help you with today?"
        }
      },
      {
        "type": "extension",
        "name": "message_collector",
        "addon": "message_collector2",
        "extension_group": "transcriber",
        "property": {}
      },
      {
        "type": "extension",
        "name": "streamid_adapter",
        "addon": "streamid_adapter",
        "property": {}
      }
    ],
    "connections": [
      {
        "extension": "main_control",
        "cmd": [
          {
            "names": ["on_user_joined", "on_user_left"],
            "source": [{"extension": "agora_rtc"}]
          }
        ],
        "data": [
          {
            "name": "asr_result",
            "source": [{"extension": "stt"}]
          }
        ]
      },
      {
        "extension": "agora_rtc",
        "audio_frame": [
          {
            "name": "pcm_frame",
            "dest": [{"extension": "streamid_adapter"}]
          },
          {
            "name": "pcm_frame",
            "source": [{"extension": "tts"}]
          }
        ],
        "data": [
          {
            "name": "data",
            "source": [{"extension": "message_collector"}]
          }
        ]
      },
      {
        "extension": "streamid_adapter",
        "audio_frame": [
          {
            "name": "pcm_frame",
            "dest": [{"extension": "stt"}]
          }
        ]
      }
    ]
  }
}
